<p-sidebar [(visible)]="commentOpen" (onHide)="hideComment()" position="right"
  [style]="{width: '31rem', borderRadius: '10px 0 0 10px', backgroundColor: '#262626'}">
  <ng-template pTemplate="header">
    <h2 style="color: rgb(249, 250, 250);">Comment Section</h2>
  </ng-template>
  <ng-template pTemplate="footer">
    <h4 style="color: rgb(249, 250, 250);">Comment</h4>
    <div>
      <input type="text" autocomplete="off" placeholder="Whats your problem Green" class="form-control input-field-specs" id="usr" [(ngModel)]="parentComment">
      <br>
      <div class="d-grid gap-2">
        <button class="btn btn-outline-light" style="border-radius: 20px;" (click)="parentCommentSave()"> Comment</button>
      </div>
    </div>
  </ng-template>
  <ng-template pTemplate="content">
    <div #commentbox>
      <div *ngFor="let comment of commentTree; let i = index">
        <div class="card card-background">
          <img class="user-pic" [src]="comment.author.profilePicture">
          <div class="user-name">
            {{comment.author.name}}
          </div>
          <!-- <div  class="user-time">
            {{this.utcToLocal(nodes?.createdAt)}}
          </div> -->
          <div class="user-comment">
            {{comment.commentStr}}
          </div>
        </div>
        <button  class="button-link" *ngIf="UserVerify(comment.author.id)" (click)="UserVerify(comment.author.id);toggleSectionEdit(comment.id)">Edit</button>
        <button class="button-link" #replyparent (click)="toggleSection(comment.id)">Reply</button>
        <section [ngStyle]="{ display: showSection[comment.id]? 'block' : 'none' }">
          <div class="form-p">
            <input type="text" placeholder="Replying to {{comment.author.name}}" autocomplete="off" class="form-control input-field-specs"
              id="{{comment.id}}" ngModel>
              <button class="btn btn-outline-light comment-btn-posi-parent-can"  (click)="replyparent.click()" >Cancle</button>
            <br><button class="btn btn-outline-light comment-btn-posi-parent"  (click)="submit($event , comment.id)" >Send
              Reply</button>
          </div>
        </section>
        <section [ngStyle]="{display: showEditSection[comment.id]? 'block' : 'none' }">
          <div class="form-p">
            <textarea [(ngModel)]="comment.commentStr" class="form-control input-field-specs"
              id="{{comment.id}}" ngModel></textarea>
              <button class="btn btn-outline-light comment-btn-posi-parent-can"  (click)="toggleSectionEdit(comment.id)" >Cancle</button>
            <br><button class="btn btn-outline-light comment-btn-posi-parent"  (click)="submitEdit(comment.commentStr, comment.id)" >Send
              Reply</button>
          </div>
        </section>
        <div class="inrComment">
          <div *ngFor="let child of comment.childs;">
            <div class="card card-background">
              <img class="user-pic" [src]="child.author.profilePicture">
              <div class="user-name">
                {{child.author.name}}
              </div>
               <!-- <div class="user-time">
                {{this.utcToLocal(child?.createdAt)}}
              </div> -->
              <div class="user-comment">
                {{child.commentStr}}
              </div>
            </div>
            <button class="button-link" *ngIf="UserVerify(child.author.id)" (click)="UserVerify(child.author.id);toggleSectionEdit(child.id)">Edit</button>
            <button class="button-link" #replychild (click)="toggleSection(child.id)">Reply</button>
            <section [ngStyle]="{ display: showSection[child.id]? 'block' : 'none' }">
              <div class="form-p">
                <input type="text" placeholder="Replying to {{child.author.name}}" autocomplete="off" class="form-control input-field-specs"
                  id="{{child.id}}" ngModel>
                  <button class="btn btn-outline-light comment-btn-posi-child-can"  (click)="replychild.click()" >Cancle</button>
                <br><button class="btn btn-outline-light comment-btn-posi-child"  (click)="submit($event, child.id)">Send
                  Reply</button>
              </div>
            </section>
            <section [ngStyle]="{ display: showEditSection[child.id]? 'block' : 'none' }">
              <div class="form-p">
                <textarea type="text" [(ngModel)]="child.commentStr" class="form-control input-field-specs"
                  id="{{child.id}}" ngModel></textarea>
                  <button class="btn btn-outline-light comment-btn-posi-child-can"  (click)="toggleSectionEdit(child.id)" >Cancle</button>
                <br><button class="btn btn-outline-light comment-btn-posi-child"  (click)="submitEdit(child.commentStr, child.id)">Send
                  Reply</button>
              </div>
            </section>
            <div class="inrComment" style="margin-left: 20px;">
              <ng-container *ngIf="child.childs.length>0" >
              <div *ngFor="let child of child.childs;">
                <div class="card card-background">
                  <img class="user-pic" [src]="child.author.profilePicture">
                  <div class="user-name">
                    {{child.author.name}}
                  </div>
                  <div class="user-comment">
                    {{child.commentStr}}
                  </div>
                </div>
                <button class="button-link" *ngIf="UserVerify(child.author.id)" (click)="UserVerify(child.author.id);toggleSectionEdit(child.id)">Edit</button>
                <button class="button-link" #replychild (click)="toggleSection(child.id)">Reply</button>
                <section [ngStyle]="{ display: showSection[child.id]? 'block' : 'none' }">
                  <div class="form-p">
                    <input type="text" placeholder="Replying to {{child.author.name}}" autocomplete="off" class="form-control input-field-specs"
                      id="{{child.id}}" ngModel>
                      <button class="btn btn-outline-light comment-btn-posi-child-can"  (click)="replychild.click()" >Cancle</button>
                    <br><button class="btn btn-outline-light comment-btn-posi-child"  (click)="submit($event, child.id)">Send
                      Reply</button>
                  </div>
                </section>
                <section [ngStyle]="{ display: showEditSection[child.id]? 'block' : 'none' }">
                  <div class="form-p">
                    <textarea type="text" [(ngModel)]="child.commentStr" class="form-control input-field-specs"
                      id="{{child.id}}" ngModel></textarea>
                      <button class="btn btn-outline-light comment-btn-posi-child-can"  (click)="toggleSectionEdit(child.id)" >Cancle</button>
                    <br><button class="btn btn-outline-light comment-btn-posi-child"  (click)="submitEdit(child.commentStr, child.id)">Send
                      Reply</button>
                  </div>
                </section>
              </div>
            </ng-container>
              <br>
              <a>--------------------------------------------------------------------</a>
              <br>
            </div>
          </div>
          <br>
          <a>--------------------------------------------------------------------</a>
          <br>
        </div>
      </div>
    </div>
  </ng-template>
</p-sidebar>
